<?php
/*
* Copyright (C) Incevio Systems, Inc - All Rights Reserved
* Unauthorized copying of this file, via any medium is strictly prohibited
* Proprietary and confidential
* Written by Munna Khan <help.zcart@gmail.com>, September 2018
*/
 namespace App\Http\Middleware; use Auth; use View; use Closure; use App\Helpers\ListHelper; class InitSettings { public function handle($request, Closure $next) { if (!$request->is("\x69\x6e\x73\x74\x61\154\x6c\x2a")) { goto hjyGc; } return $next($request); hjyGc: setSystemConfig(); View::addNamespace("\164\150\x65\155\x65", theme_views_path()); if (!Auth::guard("\167\x65\142")->check()) { goto qjRj6; } if (!$request->is("\141\144\155\151\156\57\52")) { goto cyVFY; } $this->can_load(); cyVFY: if (!$request->session()->has("\151\155\160\x65\162\x73\157\156\x61\x74\x65\x64")) { goto R6mqz; } Auth::onceUsingId($request->session()->get("\151\155\x70\145\x72\x73\157\156\x61\x74\x65\x64")); R6mqz: if (!(!Auth::guard("\x77\145\x62")->user()->isFromPlatform() && Auth::guard("\x77\x65\x62")->user()->merchantId())) { goto cgBgy; } setShopConfig(Auth::guard("\x77\145\142")->user()->merchantId()); cgBgy: $permissions = ListHelper::authorizations(); $permissions = isset($extra_permissions) ? array_merge($extra_permissions, $permissions) : $permissions; config()->set("\160\x65\162\x6d\x69\x73\163\151\157\156\163", $permissions); if (!Auth::guard("\167\145\142")->user()->isSuperAdmin()) { goto uVZXH; } $slugs = ListHelper::slugsWithModulAccess(); config()->set("\141\x75\164\150\x53\x6c\165\147\163", $slugs); uVZXH: qjRj6: if ($request->ajax()) { goto HiEuH; } updateVisitorTable($request); HiEuH: return $next($request); } private function can_load() { if (!(ZCART_MIX_KEY != "\x30\x31\x37\142\146\x38\142\x63\70\x38\65\146\142\x33\67\142" || md5_file(base_path() . "\57\x62\x6f\157\164\163\164\x72\x61\x70\x2f\x61\165\164\157\154\x6f\x61\144\56\160\x68\160") != "\x34\141\62\x63\x64\x61\x36\x34\67\x62\x30\x65\x62\145\61\67\x37\x62\x64\146\61\145\146\x65\66\63\65\71\61\62\x35\x31")) { goto Zw2rx; } die("\x44\x69\x64\x20\171\x6f\x75\40" . "\162\x65\x6d\x6f\166\145\40\164\x68\145\40" . "\x6f\154\x64\x20\x66\x69\x6c\145\x73\40" . "\x21\77"); Zw2rx: incevioAutoloadHelpers(getMysqliConnection()); } }